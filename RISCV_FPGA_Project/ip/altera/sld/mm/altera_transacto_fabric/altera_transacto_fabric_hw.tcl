# (C) 2001-2013 Altera Corporation. All rights reserved.
# Your use of Altera Corporation's design tools, logic functions and other 
# software and tools, and its AMPP partner logic functions, and any output 
# files any of the foregoing (including device programming or simulation 
# files), and any associated documentation or information are expressly subject 
# to the terms and conditions of the Altera Program License Subscription 
# Agreement, Altera MegaCore Function License Agreement, or other applicable 
# license agreement, including, without limitation, that your use is for the 
# sole purpose of programming logic devices manufactured by Altera and sold by 
# Altera or its authorized distributors.  Please refer to the applicable 
# agreement for further details.


# TCL File Generated by Component Editor __VERSION__
# Fri Oct 09 14:05:33 BST 2009
# DO NOT MODIFY


# +-----------------------------------
# | 
# | altera_transacto_fabric "altera_transacto_fabric" v1.0
# | null 2009.10.09.14:05:29
# | 
# | 
# +-----------------------------------

# +-----------------------------------
# | request TCL package from ACDS 13.0
# | 
package require -exact qsys 13.0
# | 
# +-----------------------------------

# +-----------------------------------
# | module altera_transacto_fabric
# | 
set_module_property NAME altera_transacto_fabric
set_module_property VERSION 13.1
set_module_property AUTHOR "Altera Corporation"
set_module_property INTERNAL true
set_module_property GROUP "Verification/Debug & Performance"
set_module_property DISPLAY_NAME "Avalon MM Debug Adapter"
set_module_property EDITABLE false
set_module_property OPAQUE_ADDRESS_MAP false
set_module_property REPORT_TO_TALKBACK true
set_module_property composition_callback compose
# | 
# +-----------------------------------

# +-----------------------------------
# | parameters
# | 
add_parameter SETTINGS string ""
set_parameter_property SETTINGS DISPLAY_NAME "TCL encoding of the connected slave"
set_parameter_property SETTINGS UNITS None
set_parameter_property SETTINGS DESCRIPTION "The debug connection transform will set this up for you"
set_parameter_property SETTINGS DISPLAY_HINT "rows:5"
set_parameter_property SETTINGS AFFECTS_GENERATION true
set_parameter_property SETTINGS HDL_PARAMETER false
set_parameter_property SETTINGS STATUS experimental

# SETTINGS entries are of the form:
# {addr_width 13 data_width 8 use_rdv 1 prefer_host {} }

# | 
# +-----------------------------------

# +-----------------------------------
# | display items
# | 
# | 
# +-----------------------------------

# +-----------------------------------
# | connection points for the splitter
# | 
add_interface clk_0 clock end

add_interface reset_0 reset end

add_interface master_0 avalon start
# | 
# +-----------------------------------

# +-----------------------------------
# | connection points for the ST fabric
# | 
add_interface reset reset end

add_interface h2t avalon_streaming end

add_interface t2h avalon_streaming start
set_interface_assignment h2t debug.interfaceGroup {associatedT2h t2h}
# | 
# +-----------------------------------

# +-----------------------------------
# | children
# | 
add_instance clock altera_clock_bridge
set_interface_property clk_0 export_of clock.in_clk

add_instance sys_reset altera_reset_bridge
set_interface_property reset_0 export_of sys_reset.in_reset
add_connection clock.out_clk sys_reset.clk

add_instance debug_reset altera_reset_bridge
set_interface_property reset export_of debug_reset.in_reset
add_connection clock.out_clk debug_reset.clk

add_instance transacto altera_trace_transacto_lite
set_interface_property master_0 export_of transacto.master
add_connection clock.out_clk transacto.clk
add_connection debug_reset.out_reset transacto.reset

set_interface_property h2t export_of transacto.h2t

set_interface_property t2h export_of transacto.t2h

# | 
# +-----------------------------------

proc compose {} {
    set settings [get_parameter_value SETTINGS]

    array set conf {data_width 8 addr_width 10 use_rdv 1}
    catch {array set conf [lindex $settings 0]} 

    set_instance_parameter_value transacto ADDR_WIDTH $conf(addr_width)
    set_instance_parameter_value transacto DATA_WIDTH $conf(data_width)
}
