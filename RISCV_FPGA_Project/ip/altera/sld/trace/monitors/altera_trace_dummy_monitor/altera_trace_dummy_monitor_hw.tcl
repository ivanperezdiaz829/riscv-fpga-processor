# (C) 2001-2013 Altera Corporation. All rights reserved.
# Your use of Altera Corporation's design tools, logic functions and other 
# software and tools, and its AMPP partner logic functions, and any output 
# files any of the foregoing (including device programming or simulation 
# files), and any associated documentation or information are expressly subject 
# to the terms and conditions of the Altera Program License Subscription 
# Agreement, Altera MegaCore Function License Agreement, or other applicable 
# license agreement, including, without limitation, that your use is for the 
# sole purpose of programming logic devices manufactured by Altera and sold by 
# Altera or its authorized distributors.  Please refer to the applicable 
# agreement for further details.


# TCL File Generated by Component Editor 10.1
# Tue May 10 11:42:09 BST 2011
# DO NOT MODIFY

# +-----------------------------------
# | request TCL package from ACDS 10.1
# |
package require -exact sopc 10.1
# |
# +-----------------------------------

# +-----------------------------------
# | module trace_ts_module
# |
set_module_property NAME                         altera_trace_dummy_monitor
set_module_property VERSION                      13.1
set_module_property AUTHOR                       "Altera Corporation"
set_module_property INTERNAL                     true
set_module_property GROUP                        "Verification/Debug & Performance/Trace"
set_module_property OPAQUE_ADDRESS_MAP           true
set_module_property DISPLAY_NAME                 altera_trace_dummy_monitor
set_module_property TOP_LEVEL_HDL_FILE           altera_trace_dummy_monitor.v
set_module_property TOP_LEVEL_HDL_MODULE         altera_trace_dummy_monitor
set_module_property INSTANTIATE_IN_SYSTEM_MODULE true
set_module_property EDITABLE                     false
set_module_property ANALYZE_HDL                  false
set_module_property ELABORATION_CALLBACK         elaborate
# |
# +-----------------------------------

# +-----------------------------------
# | files
# |
add_file altera_trace_dummy_monitor.v {SYNTHESIS SIMULATION}
# |
# +-----------------------------------

# +-----------------------------------
# | parameters
# |
add_parameter          TRACE_DATA_WIDTH INTEGER 32
set_parameter_property TRACE_DATA_WIDTH DEFAULT_VALUE 32
set_parameter_property TRACE_DATA_WIDTH DISPLAY_NAME TRACE_DATA_WIDTH
set_parameter_property TRACE_DATA_WIDTH TYPE INTEGER
set_parameter_property TRACE_DATA_WIDTH UNITS None
set_parameter_property TRACE_DATA_WIDTH AFFECTS_GENERATION false
set_parameter_property TRACE_DATA_WIDTH HDL_PARAMETER true

add_parameter          TRACE_SYMBOL_WIDTH INTEGER 8
set_parameter_property TRACE_SYMBOL_WIDTH DEFAULT_VALUE 8
set_parameter_property TRACE_SYMBOL_WIDTH DISPLAY_NAME TRACE_SYMBOL_WIDTH
set_parameter_property TRACE_SYMBOL_WIDTH TYPE INTEGER
set_parameter_property TRACE_SYMBOL_WIDTH UNITS None
set_parameter_property TRACE_SYMBOL_WIDTH VISIBLE false
set_parameter_property TRACE_SYMBOL_WIDTH AFFECTS_GENERATION false
set_parameter_property TRACE_SYMBOL_WIDTH HDL_PARAMETER true

add_parameter          WAKE_UP_RUNNING INTEGER 0
set_parameter_property WAKE_UP_RUNNING DEFAULT_VALUE 0
set_parameter_property WAKE_UP_RUNNING DISPLAY_NAME WAKE_UP_RUNNING
set_parameter_property WAKE_UP_RUNNING TYPE INTEGER
set_parameter_property WAKE_UP_RUNNING UNITS None
set_parameter_property WAKE_UP_RUNNING VISIBLE false
set_parameter_property WAKE_UP_RUNNING AFFECTS_GENERATION false
set_parameter_property WAKE_UP_RUNNING HDL_PARAMETER true
# |
# +-----------------------------------

# +-----------------------------------
# | display items
# |
# |
# +-----------------------------------

# +-----------------------------------
# | connection point clock
# |
add_interface clock clock end
set_interface_property clock clockRate 0

set_interface_property clock ENABLED true

add_interface_port clock clk clk Input 1
# |
# +-----------------------------------

# +-----------------------------------
# | connection point reset_sink
# |
add_interface reset_sink reset end
set_interface_property reset_sink associatedClock clock
set_interface_property reset_sink synchronousEdges DEASSERT

set_interface_property reset_sink ENABLED true

add_interface_port reset_sink arst_n reset_n Input 1
# |
# +-----------------------------------

## +-----------------------------------
## | connection point traced_interface
## |
#add_interface          traced_interface avalon_streaming  end
#set_interface_property traced_interface associatedClock   clock
#set_interface_property traced_interface associatedReset   reset_sink
#set_interface_property traced_interface dataBitsPerSymbol 8
#set_interface_property traced_interface errorDescriptor ""
#set_interface_property traced_interface maxChannel 0
#set_interface_property traced_interface readyLatency 0
#
#set_interface_property traced_interface ENABLED true
#
#add_interface_port traced_interface iut_st_ready ready         Output 1
#add_interface_port traced_interface iut_st_valid valid         Input  1
#add_interface_port traced_interface iut_st_sop   startofpacket Input  1
#add_interface_port traced_interface iut_st_eop   endofpacket   Input  1
#add_interface_port traced_interface iut_st_data  data          Input  8
##add_interface_port traced_interface iut_st_empty empty         Input  "(non-static) - (0) + 1"
## |
## +-----------------------------------


add_interface          csr avalon                     end
set_interface_property csr addressUnits               WORDS
set_interface_property csr associatedClock            clock
set_interface_property csr associatedReset            reset_sink
set_interface_property csr burstOnBurstBoundariesOnly false
set_interface_property csr linewrapBursts             false
set_interface_property csr readLatency                2
set_interface_property csr readWaitTime               0
set_interface_property csr writeWaitTime              0
set_interface_property csr ENABLED                    true

add_interface_port     csr csr_s_write             write         input  1
add_interface_port     csr csr_s_read              read          input  1
add_interface_port     csr csr_s_address           address       input  4
add_interface_port     csr csr_s_write_data        writedata     input  32
#add_interface_port     csr csr_s_waitrequest       waitrequest   output 1
add_interface_port     csr csr_s_readdata          readdata      output 32




proc log2ceil {num} {
    #make log(0), log(1) = 1
    set val 1
    set i 1
    while {$i < $num} {
        set val [expr $val + 1]
        set i [expr 1 << $val]
    }
    return $val;
}

proc elaborate {} {
    set data_symbols [log2ceil [expr [get_parameter_value TRACE_DATA_WIDTH] / 8]]

add_interface          capture avalon_streaming  start
set_interface_property capture associatedClock   clock
set_interface_property capture associatedReset   reset_sink
set_interface_property capture dataBitsPerSymbol [get_parameter_value TRACE_SYMBOL_WIDTH]
set_interface_property capture errorDescriptor   ""
set_interface_property capture maxChannel        0
set_interface_property capture readyLatency      0
set_interface_property capture ENABLED           true
set_interface_assignment capture debug.providesServices traceMonitor
set_interface_assignment capture debug.interfaceGroup {associatedControl csr}
add_interface_port     capture av_st_tr_ready    ready         Input  1
add_interface_port     capture av_st_tr_valid    valid         Output 1
add_interface_port     capture av_st_tr_sop      startofpacket Output 1
add_interface_port     capture av_st_tr_eop      endofpacket   Output 1
add_interface_port     capture av_st_tr_data     data          Output [get_parameter_value TRACE_DATA_WIDTH]
add_interface_port     capture av_st_tr_empty    empty         Output $data_symbols
}



